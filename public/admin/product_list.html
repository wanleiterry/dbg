<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<title>后台管理系统</title>
<link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="../css/bootstrap-theme.min.css">
<link rel="stylesheet" type="text/css" href="css/common.css" />
</head>
<body>
<div id="header"></div>
<div class="main clearfix container">
  	<div id="left"></div>
  	<div class="rt_wrap content mCustomScrollbar">
		<p>
			<button type="button" class="btn btn-danger" class="addproduct" data-toggle="modal"  data-target=".creategoods">
				<span class='glyphicon glyphicon-plus'></span>增加案例
			</button>
		</p>
  		<div class="table-responsive">
			<table class="table">
				<tbody>
					<table class="table table-hover goods-list">
				        <thead>
					        <tr>
					            <th style='width:10%'></th>
					            <th style='width:15%'>商品</th>
					            <th style='width:45%'>描述</th>
					            <th style='width:20%'><a>发布时间</a></th>
					            <th style='width:10%'>管理</th>
					        </tr>
				        </thead>
				        <tbody id="goods-list"></tbody>				        
				    </table>
				    <table class="table">
				    	<tbody>
				    		<tr>
				    			<td>
				    				<div class="pull-left">
				    					共有<span class="total_num"></span>条数据
				    				</div>
				    				<div class="pull-right">
				    					<nav>
		                                    <ul class="pagination">
		                                        <li class="disabled">
		                                            <a href="#" aria-label="Previous">
		                                                <span aria-hidden="true">«</span>
		                                            </a>
		                                        </li>
		                                        <li class="active"><a href="#">1</a></li>
		                                        <li><a href="#">2</a></li>
		                                        <li><a href="#">3</a></li>
		                                        <li><a href="#">4</a></li>
		                                        <li><a href="#">5</a></li>
		                                        <li>
		                                            <a href="#" aria-label="Next">
		                                                <span aria-hidden="true">»</span>
		                                            </a>
		                                        </li>
		                                    </ul>
		                                </nav>
				    				</div>
				    				<div class="clearfix"></div>
				    			</td>
				    		</tr>
				    	</tbody>
				    </table>
				</tbody>
			</table>
		</div>
  	</div>
  	<div class="modal fade changegoods" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
	        	<div class="modal-header">
	        		<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
	        		<h4>案例展示</h4>
	      		</div>
            	<form class="form-horizontal">
            		<span class="change_product_id" style='display: none'></span>
				  	<div class="form-group">
				    	<label for="inputEmail3" class="col-sm-2 control-label">标题</label>
				    	<div class="col-sm-10">
				      		<input type="text" class="form-control" id="inputEmail3" placeholder="标题">
				    	</div>
				  	</div>
				  	<div class="form-group">
				    	<label for="inputPassword3" class="col-sm-2 control-label">内容</label>
				    	<div class="col-sm-10">
				      		<textarea class="form-control" id='content'>
				      			
				      		</textarea>
				    	</div>
				  	</div>
				  	<div class="form-group">
				    	<label for="inputPassword3" class="col-sm-2 control-label">图片</label>
				    	<div class="col-sm-10">
				    		 <input type="file" id="exampleInputFile">
				    	</div>
				  	</div>
				  	<div class="form-group">
				  		<label for="inputPassword3" class="col-sm-2 control-label">图片预览</label>
				  		<div class="col-sm-10">
				  		</div>
				  	</div>
				  	<div class="form-group">
				    	<div class="col-sm-offset-2 col-sm-10">
				      		<ul class="list-inline">
				      			<li>				      				
				      				<button type="button" class="btn btn-default" id="ok">保存</button>
				      			</li>
				      			<li>				      				
				      				<button type="button" class="btn btn-default">取消</button>
				      			</li>
				      		</ul>
				    	</div>
				  	</div>
				</form>
            </div>
        </div>
    </div>
	<div class="modal fade creategoods" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
	        	<div class="modal-header">
	        		<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
	        		<h4>案例展示</h4>
	      		</div>
            	<form class="form-horizontal">
            		<span class="change_product_id" style='display: none'></span>
				  	<div class="form-group">
				    	<label for="inputEmail3" class="col-sm-2 control-label">标题</label>
				    	<div class="col-sm-10">
				      		<input type="text" class="form-control" id="inputEmail3" placeholder="标题">
				    	</div>
				  	</div>
				  	<div class="form-group">
				    	<label for="inputPassword3" class="col-sm-2 control-label">内容</label>
				    	<div class="col-sm-10">
				      		<textarea class="form-control" id='content'>
				      			
				      		</textarea>
				    	</div>
				  	</div>
				  	<div class="form-group">
				    	<label for="inputPassword3" class="col-sm-2 control-label">图片</label>
				    	<div class="col-sm-10">
				    		 <input type="file" id="uploadimg">
				    	</div>
						<div class='col-sm-12'>
							<input type="text" class="form-control" id="img" placeholder="图片">
						</div>
				  	</div>
				  	<div class="form-group">
				    	<div class="col-sm-offset-2 col-sm-10">
				      		<ul class="list-inline">
				      			<li>				      				
				      				<button type="button" class="btn btn-default" id="create">保存</button>
				      			</li>
				      			<li>				      				
				      				<button type="button" class="btn btn-default" id="quxiao">取消</button>
				      			</li>
				      		</ul>
				    	</div>
				  	</div>
				</form>
            </div>
        </div>
    </div>
</div>
</body>
<script type="text/javascript" src="../js/jquery-1.8.0.min.js"></script>
<script type="text/javascript" src="../js/bootstrap.min.js"></script>
<script type="text/javascript">$("#header").load("header.html");</script>
<script type="text/javascript">$("#left").load("left.html");</script>
<script>
	$(function(){
		function loadlist(){
			$.ajax({
				url:'/product/list.json',
				type: "get",
				dataType: "json",
				data: '',
				success: function(data){
					$('.total_num').html(''+data._count+'');
					var json=data.data;
					var str='';
					for(var i=0;i<json.length;i++){
						console.log(i)
						str+='<tr><td><img class="goods-image" src="'+json[i].pic+'" width="60px" height="60px"></td>';
						str+='<td><p>'+json[i].name+'</p></td>';
						str+='<td><p>'+json[i].desc+'</p></td>';
						str+='<td>'+json[i].updated_at+'</td>';
						str+='<td><p><a onclick="edit('+json[i].id+')" data-toggle="modal"  data-target=".changegoods"> 编辑</a>';
						str+='<span>|</span><a class="delete" id="'+json[i].id+'">删除</a></p></td></tr>';
					}
					$('#goods-list').html(str);
				}
			});
		}
		$('.delete').bind('click',function(){
			var id=$(this).attr("id");
			alert(id);
			if(window.confirm('你确定要删除选中的产品吗？')){
				//alert("确定");
				$.ajax({
					url: '/admin/product/'+id+'.json',
					type:"delete",
					dataType:"json",
					data:'',
					success:function(data){
						console.log(data);
						loadlist();
					}
				});
			}
			else{
				return false;
			}	
		})
		function delgoods(id){
			console.log(id);
			if(window.confirm('你确定要删除选中的产品吗？')){
				//alert("确定");
				$.ajax({
					url: '/admin/product/'+id+'.json',
					type:"delete",
					dataType:"json",
					data:'',
					success:function(data){
						console.log(data);
						loadlist();
					}
				});
			}
			else{
				return false;
			}	
		}
		function edit(id) {
			$.ajax({
				url:'/product/'+id+'.json',
				type: "get",
				dataType: "json",
				data: '',
				success: function(data){
					console.log(data);
					$('.change_news_id').html(''+id+'');
				}
			})
		}
		loadlist();		
		$('#create').click(function(){
			var param = {
				'desc':$('#content').val(),
				'title':$('#title').val(),
				'pic':$('#img').val()
			}
			$.ajax({
				url: '/admin/news/create.json',
				type:"post",
				dataType:"json",
				data:param,
				success:function(data){
					console.log(data);
					$('.close').click()
					loadlist();
				}
			});
		});
		$("#quxiao").click(function(){
			$(".close").click();
		})
	})
</script>
</html>
